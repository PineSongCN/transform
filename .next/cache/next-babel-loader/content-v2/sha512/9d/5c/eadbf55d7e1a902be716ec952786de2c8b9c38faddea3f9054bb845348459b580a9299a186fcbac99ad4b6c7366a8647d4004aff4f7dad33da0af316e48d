{"ast":null,"code":"import { convert } from \"@khanacademy/flow-to-ts\";\nimport * as ts from \"typescript\";\nexport default ((req, res) => {\n  try {\n    const {\n      value,\n      declarationOnly,\n      isTS\n    } = req.body;\n    const tsCode = isTS ? value : convert(value);\n\n    if (!declarationOnly) {\n      res.status(200).send(tsCode);\n      return;\n    }\n\n    let output = \"\";\n    const options = {\n      allowJs: true,\n      declaration: true,\n      emitDeclarationOnly: true,\n      jsx: ts.JsxEmit.React,\n      skipDefaultLibCheck: true,\n      skipLibCheck: true\n    };\n    const host = ts.createCompilerHost(options);\n\n    host.getSourceFile = filename => {\n      if (filename === \"file.ts\") {\n        return ts.createSourceFile(filename, tsCode, undefined);\n      }\n\n      return ts.createSourceFile(filename, \"\", undefined);\n    };\n\n    host.writeFile = (_name, text) => {\n      output = text;\n    };\n\n    const program = ts.createProgram([\"file.ts\"], options, host);\n    program.emit();\n    res.status(200).send(output);\n  } catch (e) {\n    console.log(e);\n    res.status(500).send(e.message);\n  }\n});","map":null,"metadata":{},"sourceType":"module"}