{"code":"_N_E=(\"object\"!==typeof self?self:this.webpackJsonp_N_E=\"object\"!==typeof self?self:this.webpackJsonp_N_E||[]).push([[51],{CN9R:function(e,t,r){var n=r(\"kfWR\"),o=r(\"DQ9f\");e.exports=n,e.exports.parse=n,e.exports.stringify=o},DQ9f:function(e,t){var r=function(e,t){var r=e.repeated?\"repeated\":e.required?\"required\":\"optional\";\"map\"===e.type&&(r=\"map<\"+e.map.from+\",\"+e.map.to+\">\"),e.oneof&&(r=\"\");var n=Object.keys(e.options||{}).map((function(t){return t+\" = \"+e.options[t]})).join(\",\");return n&&(n=\" [\"+n+\"]\"),t.push((r?r+\" \":\"\")+(\"map\"===e.map?\"\":e.type+\" \")+e.name+\" = \"+e.tag+n+\";\"),t},n=function(e,t){t.push(\"message \"+e.name+\" {\"),e.enums||(e.enums=[]),e.enums.forEach((function(e){t.push(o(e,[]))})),e.messages||(e.messages=[]),e.messages.forEach((function(e){t.push(n(e,[]))}));var s={};return e.fields||(e.fields=[]),e.fields.forEach((function(e){e.oneof?(s[e.oneof]||(s[e.oneof]=[]),s[e.oneof].push(r(e,[]))):t.push(r(e,[]))})),Object.keys(s).forEach((function(e){s[e].unshift(\"oneof \"+e+\" {\"),s[e].push(\"}\"),t.push(s[e])})),t.push(\"}\",\"\"),t},o=function(e,t){t.push(\"enum \"+e.name+\" {\");var r=Object.keys(e.values).map((function(t){return t+\" = \"+e.values[t]+\";\"}));return t.push(r),t.push(\"}\",\"\"),t},s=function(e,t){var r=Object.keys(e);return r.forEach((function(r){var n=e[r];~r.indexOf(\".\")&&(r=\"(\"+r+\")\");var o=typeof n;\"object\"===o?(n=i(n,[])).length&&t.push(\"option \"+r+\" = {\",n,\"};\"):(\"string\"===o&&\"optimize_for\"!==r&&(n='\"'+n+'\"'),t.push(\"option \"+r+\" = \"+n+\";\"))})),r.length>0&&t.push(\"\"),t},i=function(e,t){return Object.keys(e).forEach((function(r){var n=e[r],o=typeof n;\"object\"===o?Array.isArray(n)?n.forEach((function(e){(e=i(e,[])).length&&t.push(r+\" {\",e,\"}\")})):(n=i(n,[])).length&&t.push(r+\" {\",n,\"}\"):(\"string\"===o&&(n='\"'+n+'\"'),t.push(r+\": \"+n))})),t},a=function(e,t){var r=\"rpc \"+e.name+\"(\";e.client_streaming&&(r+=\"stream \"),r+=e.input_type+\") returns (\",e.server_streaming&&(r+=\"stream \"),r+=e.output_type+\")\",e.options||(e.options={});var n=s(e.options,[]);return n.length>1?t.push(r+\" {\",n.slice(0,-1),\"}\"):t.push(r+\";\"),t},f=function(e){return function(t){return Array.isArray(t)?t.map(f(e+\"  \")).join(\"\\n\"):e+t}};e.exports=function(e){var t=[];return t.push('syntax = \"proto'+e.syntax+'\";',\"\"),e.package&&t.push(\"package \"+e.package+\";\",\"\"),e.options||(e.options={}),s(e.options,t),e.enums||(e.enums=[]),e.enums.forEach((function(e){o(e,t)})),e.messages||(e.messages=[]),e.messages.forEach((function(e){n(e,t)})),e.services&&e.services.forEach((function(e){!function(e,t){t.push(\"service \"+e.name+\" {\"),e.options||(e.options={}),s(e.options,t),e.methods||(e.methods=[]),e.methods.forEach((function(e){t.push(a(e,[]))})),t.push(\"}\",\"\")}(e,t)})),t.map(f(\"\")).join(\"\\n\")}},apke:function(e,t,r){\"use strict\";r.r(t),r.d(t,\"default\",(function(){return h}));var n=r(\"nKUr\"),o=r(\"vJKn\"),s=r.n(o),i=r(\"rg98\"),a=r(\"sN8P\"),f=r(\"q1tI\"),u=r(\"pIeg\"),p=r.n(u);function h(){var e=Object(f.useCallback)(function(){var e=Object(i.a)(s.a.mark((function e(t){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.value,e.abrupt(\"return\",p()(r));case 2:case\"end\":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]);return Object(n.jsx)(a.a,{transformer:e,editorTitle:\"JSON Schema\",editorLanguage:\"json\",editorDefaultValue:\"jsonSchema\",resultTitle:\"Protobuf\",resultLanguage:\"text\"})}},kfWR:function(e,t,r){var n=r(\"lelp\"),o=function(e){for(var t={};e.length;)switch(e[0]){case\"[\":case\",\":e.shift();var r=e.shift();if(\"(\"===r&&(r=e.shift(),e.shift()),\"=\"!==e[0])throw new Error(\"Unexpected token in field options: \"+e[0]);if(e.shift(),\"]\"===e[0])throw new Error(\"Unexpected ] in field option\");t[r]=e.shift();break;case\"]\":return e.shift(),t;default:throw new Error(\"Unexpected token in field options: \"+e[0])}throw new Error(\"No closing tag for field options\")},s=function(e){for(var t={name:null,type:null,tag:0,map:null,oneof:null,required:!1,repeated:!1,options:{}};e.length;)switch(e[0]){case\"=\":e.shift(),t.tag=Number(e.shift());break;case\"map\":if(t.type=\"map\",t.map={from:null,to:null},e.shift(),\"<\"!==e[0])throw new Error(\"Unexpected token in map type: \"+e[0]);if(e.shift(),t.map.from=e.shift(),\",\"!==e[0])throw new Error(\"Unexpected token in map type: \"+e[0]);if(e.shift(),t.map.to=e.shift(),\">\"!==e[0])throw new Error(\"Unexpected token in map type: \"+e[0]);e.shift(),t.name=e.shift();break;case\"repeated\":case\"required\":case\"optional\":var r=e.shift();t.required=\"required\"===r,t.repeated=\"repeated\"===r,t.type=e.shift(),t.name=e.shift();break;case\"[\":t.options=o(e);break;case\";\":return e.shift(),t;default:throw new Error(\"Unexpected token in message field: \"+e[0])}throw new Error(\"No ; found for message field\")},i=function(e){for(var t={enums:[],messages:[],fields:[],extensions:null};e.length;)switch(e[0]){case\"map\":case\"repeated\":case\"optional\":case\"required\":t.fields.push(s(e));break;case\"enum\":t.enums.push(l(e));break;case\"message\":t.messages.push(u(e));break;case\"extensions\":t.extensions=f(e);break;case\"oneof\":e.shift();var r=e.shift();if(\"{\"!==e[0])throw new Error(\"Unexpected token in oneof: \"+e[0]);for(e.shift();\"}\"!==e[0];){e.unshift(\"optional\");var n=s(e);n.oneof=r,t.fields.push(n)}e.shift();break;case\";\":e.shift();break;default:e.unshift(\"optional\"),t.fields.push(s(e))}return t},a=function(e){return{name:e[1],message:u(e)}},f=function(e){e.shift();var t=Number(e.shift());if(isNaN(t))throw new Error(\"Invalid from in extensions definition\");if(\"to\"!==e.shift())throw new Error(\"Expected keyword 'to' in extensions definition\");var r=e.shift();if(\"max\"===r&&(r=536870911),r=Number(r),isNaN(r))throw new Error(\"Invalid to in extensions definition\");if(\";\"!==e.shift())throw new Error(\"Missing ; in extensions definition\");return{from:t,to:r}},u=function(e){e.shift();var t=1,r=[],n={name:e.shift(),enums:[],messages:[],fields:[]};if(\"{\"!==e[0])throw new Error(\"Expected { but found \"+e[0]);for(e.shift();e.length;){if(\"{\"===e[0]?t++:\"}\"===e[0]&&t--,!t)return e.shift(),r=i(r),n.enums=r.enums,n.messages=r.messages,n.fields=r.fields,n.extensions=r.extensions,n;r.push(e.shift())}if(t)throw new Error(\"No closing tag for message\")},p=function(e){e.shift();var t=e.shift();if(\";\"!==e[0])throw new Error(\"Expected ; but found \"+e[0]);return e.shift(),t},h=function(e){if(e.shift(),\"=\"!==e[0])throw new Error(\"Expected = but found \"+e[0]);e.shift();var t=e.shift();switch(t){case'\"proto2\"':t=2;break;case'\"proto3\"':t=3;break;default:throw new Error(\"Expected protobuf syntax version but found \"+t)}if(\";\"!==e[0])throw new Error(\"Expected ; but found \"+e[0]);return e.shift(),t},c=function(e){if(e.length<4)throw new Error(\"Invalid enum value: \"+e.slice(0,3).join(\" \"));if(\"=\"!==e[1])throw new Error(\"Expected = but found \"+e[1]);if(\";\"!==e[3])throw new Error(\"Expected ; but found \"+e[1]);var t=e.shift();e.shift();var r=Number(e.shift());return e.shift(),{name:t,value:r}},l=function(e){e.shift();var t={name:e.shift(),values:{}};if(\"{\"!==e[0])throw new Error(\"Expected { but found \"+e[0]);for(e.shift();e.length;){if(\"}\"===e[0])return e.shift(),\";\"===e[0]&&e.shift(),t;if(\"option\"===e[0])for(;\";\"!==e.shift(););var r=c(e);t.values[r.name]=r.value}throw new Error(\"No closing tag for enum\")},m=function(e){for(var t=null,r=null,n=function(e){return\"true\"===e||\"false\"!==e&&e.replace(/^\"+|\"+$/gm,\"\")};e.length;){if(\";\"===e[0])return e.shift(),{name:t,value:r};switch(e[0]){case\"option\":e.shift();var o=\"(\"===e[0];if(o&&e.shift(),t=e.shift(),o){if(\")\"!==e[0])throw new Error(\"Expected ) but found \"+e[0]);e.shift()}break;case\"=\":if(e.shift(),null===t)throw new Error(\"Expected key for option with value: \"+e[0]);if(r=n(e.shift()),\"optimize_for\"===t&&!/^(SPEED|CODE_SIZE|LITE_RUNTIME)$/.test(r))throw new Error(\"Unexpected value for option optimize_for: \"+r);\"{\"===r&&(r=d(e));break;default:throw new Error(\"Unexpected token in option: \"+e[0])}}},d=function(e){for(var t=function(e){return\"true\"===e||\"false\"!==e&&e.replace(/^\"+|\"+$/gm,\"\")},r={};e.length;){if(\"}\"===e[0])return e.shift(),r;var n=\"(\"===e[0];n&&e.shift();var o=e.shift();if(n){if(\")\"!==e[0])throw new Error(\"Expected ) but found \"+e[0]);e.shift()}var s=null;switch(e[0]){case\":\":if(void 0!==r[o])throw new Error(\"Duplicate option map key \"+o);e.shift(),\"{\"===(s=t(e.shift()))&&(s=d(e)),r[o]=s;break;case\"{\":if(e.shift(),s=d(e),void 0===r[o]&&(r[o]=[]),!Array.isArray(r[o]))throw new Error(\"Duplicate option map key \"+o);r[o].push(s);break;default:throw new Error(\"Unexpected token in option map: \"+e[0])}}throw new Error(\"No closing tag for option map\")},w=function(e){e.shift();var t=e.shift().replace(/^\"+|\"+$/gm,\"\");if(\";\"!==e[0])throw new Error(\"Unexpected token: \"+e[0]+'. Expected \";\"');return e.shift(),t},g=function(e){e.shift();var t={name:e.shift(),methods:[],options:{}};if(\"{\"!==e[0])throw new Error(\"Expected { but found \"+e[0]);for(e.shift();e.length;){if(\"}\"===e[0])return e.shift(),\";\"===e[0]&&e.shift(),t;switch(e[0]){case\"option\":var r=m(e);if(void 0!==t.options[r.name])throw new Error(\"Duplicate option \"+r.name);t.options[r.name]=r.value;break;case\"rpc\":t.methods.push(v(e));break;default:throw new Error(\"Unexpected token in service: \"+e[0])}}throw new Error(\"No closing tag for service\")},v=function(e){e.shift();var t={name:e.shift(),input_type:null,output_type:null,client_streaming:!1,server_streaming:!1,options:{}};if(\"(\"!==e[0])throw new Error(\"Expected ( but found \"+e[0]);if(e.shift(),\"stream\"===e[0]&&(e.shift(),t.client_streaming=!0),t.input_type=e.shift(),\")\"!==e[0])throw new Error(\"Expected ) but found \"+e[0]);if(e.shift(),\"returns\"!==e[0])throw new Error(\"Expected returns but found \"+e[0]);if(e.shift(),\"(\"!==e[0])throw new Error(\"Expected ( but found \"+e[0]);if(e.shift(),\"stream\"===e[0]&&(e.shift(),t.server_streaming=!0),t.output_type=e.shift(),\")\"!==e[0])throw new Error(\"Expected ) but found \"+e[0]);if(e.shift(),\";\"===e[0])return e.shift(),t;if(\"{\"!==e[0])throw new Error(\"Expected { but found \"+e[0]);for(e.shift();e.length;){if(\"}\"===e[0])return e.shift(),\";\"===e[0]&&e.shift(),t;if(\"option\"!==e[0])throw new Error(\"Unexpected token in rpc options: \"+e[0]);var r=m(e);if(void 0!==t.options[r.name])throw new Error(\"Duplicate option \"+r.name);t.options[r.name]=r.value}throw new Error(\"No closing tag for rpc\")};e.exports=function(e){for(var t=n(e.toString()),r=0;r<t.length;r++){var o;if(/^(\\\"|\\')([^\\'\\\"]*)$/.test(t[r]))for(o=1===t[r].length?r+1:r;o<t.length;o++)if(/^([^\\'\\\"]*)(\\\"|\\')$/.test(t[o])){t=t.slice(0,r).concat(t.slice(r,o+1).join(\"\")).concat(t.slice(o+1));break}}for(var s={syntax:3,package:null,imports:[],enums:[],messages:[],options:{},extends:[]},i=!0;t.length;){switch(t[0]){case\"package\":s.package=p(t);break;case\"syntax\":if(!i)throw new Error(\"Protobuf syntax version should be first thing in file\");s.syntax=h(t);break;case\"message\":s.messages.push(u(t));break;case\"enum\":s.enums.push(l(t));break;case\"option\":var f=m(t);if(s.options[f.name])throw new Error(\"Duplicate option \"+f.name);s.options[f.name]=f.value;break;case\"import\":s.imports.push(w(t));break;case\"extend\":s.extends.push(a(t));break;case\"service\":s.services||(s.services=[]),s.services.push(g(t));break;default:throw new Error(\"Unexpected token: \"+t[0])}i=!1}return s.extends.forEach((function(e){s.messages.forEach((function(t){t.name===e.name&&e.message.fields.forEach((function(e){if(!t.extensions||e.tag<t.extensions.from||e.tag>t.extensions.to)throw new Error(t.name+\" does not declare \"+e.tag+\" as an extension number\");t.fields.push(e)}))}))})),s}},lelp:function(e,t){e.exports=function(e){var t=function(e){return e.trim()};return e.replace(/([;,{}\\(\\)=\\:\\[\\]<>]|\\/\\*|\\*\\/)/g,\" $1 \").split(/\\n/).map(t).filter(Boolean).map((function(e){var t=e.indexOf(\"//\");return t>-1?e.slice(0,t):e})).map(t).filter(Boolean).join(\"\\n\").split(/\\s+|\\n+/gm).filter(function(){var e=!1;return function(t){return\"/*\"===t?(e=!0,!1):\"*/\"===t?(e=!1,!1):!e}}())}},pIeg:function(e,t,r){var n=r(\"CN9R\"),o={array:\"repeated\",object:\"message\",integer:\"int32\",number:\"int32\",string:\"string\",boolean:\"bool\"};function s(e){var t={name:e.name,enums:[],messages:[],fields:[]},r=1;for(var n in e.properties){\"object\"===(f=e.properties[n]).type?(f.name=n,t.messages.push(s(f))):(f.name=n,t.fields.push(i(f,r)),r+=1)}for(var o in e.required){var a=e.required[o];for(var o in t.fields){var f;a===(f=t.fields[o]).name&&(f.required=!0)}}return t}function i(e,t){var r=o[e.type]||e.type,n=!1;return\"array\"===e.type&&(n=!0,r=e.items.type),{name:e.name,type:r,tag:t,repeated:n}}e.exports=function(e){\"string\"===typeof e&&(e=JSON.parse(e));var t={syntax:2,package:null,enums:[],messages:[]};return\"object\"===e.type&&t.messages.push(s(e)),n.stringify(t)}},pof7:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push([\"/json-schema-to-protobuf\",function(){return r(\"apke\")}])}},[[\"pof7\",1,2,0,3]]]);","map":{"version":3,"sources":["static/chunks/pages/json-schema-to-protobuf-929529038cee0b79cbd1.js"],"names":["_N_E","self","this","push","CN9R","module","exports","__webpack_require__","parse","stringify","DQ9f","onfield","f","result","prefix","repeated","required","type","map","from","to","oneof","opts","Object","keys","options","key","join","name","tag","onmessage","m","enums","forEach","e","onenum","messages","oneofs","fields","n","unshift","vals","values","onoption","o","option","v","indexOf","onoptionMap","length","k","Array","isArray","onrpc","rpc","def","client_streaming","input_type","server_streaming","output_type","slice","indent","lvl","line","schema","syntax","package","services","s","methods","onservices","apke","__webpack_exports__","r","d","JsonSchemaToProtobuf","react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__","_Users_songxu_Develop_test_transform_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1__","_Users_songxu_Develop_test_transform_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default","_Users_songxu_Develop_test_transform_node_modules_next_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__","_components_ConversionPanel__WEBPACK_IMPORTED_MODULE_3__","react__WEBPACK_IMPORTED_MODULE_4__","jsonschema_protobuf__WEBPACK_IMPORTED_MODULE_5__","jsonschema_protobuf__WEBPACK_IMPORTED_MODULE_5___default","transformer","_ref2","a","mark","_callee","_ref","value","wrap","_context","prev","next","abrupt","stop","_x","apply","arguments","editorTitle","editorLanguage","editorDefaultValue","resultTitle","resultLanguage","kfWR","tokenize","onfieldoptions","tokens","shift","Error","field","Number","t","onmessagebody","body","extensions","onextensions","onextend","message","isNaN","msg","onpackagename","onsyntaxversion","version","onenumvalue","val","replace","hasBracket","test","undefined","onimport","file","onservice","service","opt","buf","toString","i","j","concat","imports","extends","firstline","ext","lelp","sch","trim","split","filter","Boolean","inside","token","noMultilineComments","pIeg","protobuf","mappings","array","object","integer","number","string","boolean","Message","properties","Field","items","JSON","pof7","window","__NEXT_P"],"mappings":"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"},"name":"static/chunks/pages/json-schema-to-protobuf-929529038cee0b79cbd1.js","input":"_N_E =\n(typeof self !== \"object\" ? self : this[\"webpackJsonp_N_E\"] = typeof self !== \"object\" ? self : this[\"webpackJsonp_N_E\"] || []).push([[51],{\n\n/***/ \"CN9R\":\n/***/ (function(module, exports, __webpack_require__) {\n\nvar parse = __webpack_require__(\"kfWR\")\nvar stringify = __webpack_require__(\"DQ9f\")\n\nmodule.exports = parse\nmodule.exports.parse = parse\nmodule.exports.stringify = stringify\n\n\n/***/ }),\n\n/***/ \"DQ9f\":\n/***/ (function(module, exports) {\n\nvar onfield = function (f, result) {\n  var prefix = f.repeated ? 'repeated' : f.required ? 'required' : 'optional'\n  if (f.type === 'map') prefix = 'map<' + f.map.from + ',' + f.map.to + '>'\n  if (f.oneof) prefix = ''\n\n  var opts = Object.keys(f.options || {}).map(function (key) {\n    return key + ' = ' + f.options[key]\n  }).join(',')\n\n  if (opts) opts = ' [' + opts + ']'\n\n  result.push((prefix ? prefix + ' ' : '') + (f.map === 'map' ? '' : f.type + ' ') + f.name + ' = ' + f.tag + opts + ';')\n  return result\n}\n\nvar onmessage = function (m, result) {\n  result.push('message ' + m.name + ' {')\n\n  if (!m.enums) m.enums = []\n  m.enums.forEach(function (e) {\n    result.push(onenum(e, []))\n  })\n\n  if (!m.messages) m.messages = []\n  m.messages.forEach(function (m) {\n    result.push(onmessage(m, []))\n  })\n\n  var oneofs = {}\n\n  if (!m.fields) m.fields = []\n  m.fields.forEach(function (f) {\n    if (f.oneof) {\n      if (!oneofs[f.oneof]) oneofs[f.oneof] = []\n      oneofs[f.oneof].push(onfield(f, []))\n    } else {\n      result.push(onfield(f, []))\n    }\n  })\n\n  Object.keys(oneofs).forEach(function (n) {\n    oneofs[n].unshift('oneof ' + n + ' {')\n    oneofs[n].push('}')\n    result.push(oneofs[n])\n  })\n\n  result.push('}', '')\n  return result\n}\n\nvar onenum = function (e, result) {\n  result.push('enum ' + e.name + ' {')\n\n  var vals = Object.keys(e.values).map(function (key) {\n    return key + ' = ' + e.values[key] + ';'\n  })\n\n  result.push(vals)\n  result.push('}', '')\n  return result\n}\n\nvar onoption = function (o, result) {\n  var keys = Object.keys(o)\n  keys.forEach(function (option) {\n    var v = o[option]\n\n    if (~option.indexOf('.')) option = '(' + option + ')'\n\n    var type = typeof v\n\n    if (type === 'object') {\n      v = onoptionMap(v, [])\n      if (v.length) result.push('option ' + option + ' = {', v, '};')\n    } else {\n      if (type === 'string' && option !== 'optimize_for') v = '\"' + v + '\"'\n      result.push('option ' + option + ' = ' + v + ';')\n    }\n  })\n  if (keys.length > 0) {\n    result.push('')\n  }\n\n  return result\n}\n\nvar onoptionMap = function (o, result) {\n  var keys = Object.keys(o)\n  keys.forEach(function (k) {\n    var v = o[k]\n\n    var type = typeof v\n\n    if (type === 'object') {\n      if (Array.isArray(v)) {\n        v.forEach(function (v) {\n          v = onoptionMap(v, [])\n          if (v.length) result.push(k + ' {', v, '}')\n        })\n      } else {\n        v = onoptionMap(v, [])\n        if (v.length) result.push(k + ' {', v, '}')\n      }\n    } else {\n      if (type === 'string') v = '\"' + v + '\"'\n      result.push(k + ': ' + v)\n    }\n  })\n\n  return result\n}\n\nvar onservices = function (s, result) {\n  result.push('service ' + s.name + ' {')\n\n  if (!s.options) s.options = {}\n\n  onoption(s.options, result)\n\n  if (!s.methods) s.methods = []\n  s.methods.forEach(function (m) {\n    result.push(onrpc(m, []))\n  })\n\n  result.push('}', '')\n  return result\n}\n\nvar onrpc = function (rpc, result) {\n  var def = 'rpc ' + rpc.name + '('\n  if (rpc.client_streaming) def += 'stream '\n  def += rpc.input_type + ') returns ('\n  if (rpc.server_streaming) def += 'stream '\n  def += rpc.output_type + ')'\n\n  if (!rpc.options) rpc.options = {}\n\n  var options = onoption(rpc.options, [])\n  if (options.length > 1) {\n    result.push(def + ' {', options.slice(0, -1), '}')\n  } else {\n    result.push(def + ';')\n  }\n\n  return result\n}\n\nvar indent = function (lvl) {\n  return function (line) {\n    if (Array.isArray(line)) return line.map(indent(lvl + '  ')).join('\\n')\n    return lvl + line\n  }\n}\n\nmodule.exports = function (schema) {\n  var result = []\n\n  result.push('syntax = \"proto' + schema.syntax + '\";', '')\n\n  if (schema.package) result.push('package ' + schema.package + ';', '')\n\n  if (!schema.options) schema.options = {}\n\n  onoption(schema.options, result)\n\n  if (!schema.enums) schema.enums = []\n  schema.enums.forEach(function (e) {\n    onenum(e, result)\n  })\n\n  if (!schema.messages) schema.messages = []\n  schema.messages.forEach(function (m) {\n    onmessage(m, result)\n  })\n\n  if (schema.services) {\n    schema.services.forEach(function (s) {\n      onservices(s, result)\n    })\n  }\n\n  return result.map(indent('')).join('\\n')\n}\n\n\n/***/ }),\n\n/***/ \"apke\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return JsonSchemaToProtobuf; });\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"nKUr\");\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _Users_songxu_Develop_test_transform_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"vJKn\");\n/* harmony import */ var _Users_songxu_Develop_test_transform_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_Users_songxu_Develop_test_transform_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _Users_songxu_Develop_test_transform_node_modules_next_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"rg98\");\n/* harmony import */ var _components_ConversionPanel__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(\"sN8P\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(\"q1tI\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var jsonschema_protobuf__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(\"pIeg\");\n/* harmony import */ var jsonschema_protobuf__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(jsonschema_protobuf__WEBPACK_IMPORTED_MODULE_5__);\n\n\n\n\n\n\n\nfunction JsonSchemaToProtobuf() {\n  var transformer = Object(react__WEBPACK_IMPORTED_MODULE_4__[\"useCallback\"])( /*#__PURE__*/function () {\n    var _ref2 = Object(_Users_songxu_Develop_test_transform_node_modules_next_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__[/* default */ \"a\"])( /*#__PURE__*/_Users_songxu_Develop_test_transform_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark(function _callee(_ref) {\n      var value;\n      return _Users_songxu_Develop_test_transform_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              value = _ref.value;\n              return _context.abrupt(\"return\", jsonschema_protobuf__WEBPACK_IMPORTED_MODULE_5___default()(value));\n\n            case 2:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function (_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }(), []);\n  return /*#__PURE__*/Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__[\"jsx\"])(_components_ConversionPanel__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"], {\n    transformer: transformer,\n    editorTitle: \"JSON Schema\",\n    editorLanguage: \"json\",\n    editorDefaultValue: \"jsonSchema\",\n    resultTitle: \"Protobuf\",\n    resultLanguage: \"text\"\n  });\n}\n\n/***/ }),\n\n/***/ \"kfWR\":\n/***/ (function(module, exports, __webpack_require__) {\n\nvar tokenize = __webpack_require__(\"lelp\")\nvar MAX_RANGE = 0x1FFFFFFF\n\nvar onfieldoptions = function (tokens) {\n  var opts = {}\n\n  while (tokens.length) {\n    switch (tokens[0]) {\n      case '[':\n      case ',':\n        tokens.shift()\n        var name = tokens.shift()\n        if (name === '(') {       // handling [(A) = B]\n          name = tokens.shift()\n          tokens.shift()          // remove the end of bracket\n        }\n        if (tokens[0] !== '=') throw new Error('Unexpected token in field options: ' + tokens[0])\n        tokens.shift()\n        if (tokens[0] === ']') throw new Error('Unexpected ] in field option')\n        opts[name] = tokens.shift()\n        break\n      case ']':\n        tokens.shift()\n        return opts\n\n      default:\n        throw new Error('Unexpected token in field options: ' + tokens[0])\n    }\n  }\n\n  throw new Error('No closing tag for field options')\n}\n\nvar onfield = function (tokens) {\n  var field = {\n    name: null,\n    type: null,\n    tag: 0,\n    map: null,\n    oneof: null,\n    required: false,\n    repeated: false,\n    options: {}\n  }\n\n  while (tokens.length) {\n    switch (tokens[0]) {\n      case '=':\n        tokens.shift()\n        field.tag = Number(tokens.shift())\n        break\n\n      case 'map':\n        field.type = 'map'\n        field.map = {from: null, to: null}\n        tokens.shift()\n        if (tokens[0] !== '<') throw new Error('Unexpected token in map type: ' + tokens[0])\n        tokens.shift()\n        field.map.from = tokens.shift()\n        if (tokens[0] !== ',') throw new Error('Unexpected token in map type: ' + tokens[0])\n        tokens.shift()\n        field.map.to = tokens.shift()\n        if (tokens[0] !== '>') throw new Error('Unexpected token in map type: ' + tokens[0])\n        tokens.shift()\n        field.name = tokens.shift()\n        break\n\n      case 'repeated':\n      case 'required':\n      case 'optional':\n        var t = tokens.shift()\n        field.required = t === 'required'\n        field.repeated = t === 'repeated'\n        field.type = tokens.shift()\n        field.name = tokens.shift()\n        break\n\n      case '[':\n        field.options = onfieldoptions(tokens)\n        break\n\n      case ';':\n        tokens.shift()\n        return field\n\n      default:\n        throw new Error('Unexpected token in message field: ' + tokens[0])\n    }\n  }\n\n  throw new Error('No ; found for message field')\n}\n\nvar onmessagebody = function (tokens) {\n  var body = {\n    enums: [],\n    messages: [],\n    fields: [],\n    extensions: null\n  }\n\n  while (tokens.length) {\n    switch (tokens[0]) {\n      case 'map':\n      case 'repeated':\n      case 'optional':\n      case 'required':\n        body.fields.push(onfield(tokens))\n        break\n\n      case 'enum':\n        body.enums.push(onenum(tokens))\n        break\n\n      case 'message':\n        body.messages.push(onmessage(tokens))\n        break\n\n      case 'extensions':\n        body.extensions = onextensions(tokens)\n        break\n\n      case 'oneof':\n        tokens.shift()\n        var name = tokens.shift()\n        if (tokens[0] !== '{') throw new Error('Unexpected token in oneof: ' + tokens[0])\n        tokens.shift()\n        while (tokens[0] !== '}') {\n          tokens.unshift('optional')\n          var field = onfield(tokens)\n          field.oneof = name\n          body.fields.push(field)\n        }\n        tokens.shift()\n        break\n\n      case ';':\n        tokens.shift()\n        break\n\n      default:\n        // proto3 does not require the use of optional/required, assumed as optional\n        // \"singular: a well-formed message can have zero or one of this field (but not more than one).\"\n        // https://developers.google.com/protocol-buffers/docs/proto3#specifying-field-rules\n        tokens.unshift('optional')\n        body.fields.push(onfield(tokens))\n    }\n  }\n\n  return body\n}\n\nvar onextend = function (tokens) {\n  var out = {\n    name: tokens[1],\n    message: onmessage(tokens)\n  }\n  return out\n}\n\nvar onextensions = function (tokens) {\n  tokens.shift()\n  var from = Number(tokens.shift())\n  if (isNaN(from)) throw new Error('Invalid from in extensions definition')\n  if (tokens.shift() !== 'to') throw new Error(\"Expected keyword 'to' in extensions definition\")\n  var to = tokens.shift()\n  if (to === 'max') to = MAX_RANGE\n  to = Number(to)\n  if (isNaN(to)) throw new Error('Invalid to in extensions definition')\n  if (tokens.shift() !== ';') throw new Error('Missing ; in extensions definition')\n  return {from: from, to: to}\n}\nvar onmessage = function (tokens) {\n  tokens.shift()\n\n  var lvl = 1\n  var body = []\n  var msg = {\n    name: tokens.shift(),\n    enums: [],\n    messages: [],\n    fields: []\n  }\n\n  if (tokens[0] !== '{') throw new Error('Expected { but found ' + tokens[0])\n  tokens.shift()\n\n  while (tokens.length) {\n    if (tokens[0] === '{') lvl++\n    else if (tokens[0] === '}') lvl--\n\n    if (!lvl) {\n      tokens.shift()\n      body = onmessagebody(body)\n      msg.enums = body.enums\n      msg.messages = body.messages\n      msg.fields = body.fields\n      msg.extensions = body.extensions\n      return msg\n    }\n\n    body.push(tokens.shift())\n  }\n\n  if (lvl) throw new Error('No closing tag for message')\n}\n\nvar onpackagename = function (tokens) {\n  tokens.shift()\n  var name = tokens.shift()\n  if (tokens[0] !== ';') throw new Error('Expected ; but found ' + tokens[0])\n  tokens.shift()\n  return name\n}\n\nvar onsyntaxversion = function (tokens) {\n  tokens.shift()\n\n  if (tokens[0] !== '=') throw new Error('Expected = but found ' + tokens[0])\n  tokens.shift()\n\n  var version = tokens.shift()\n  switch (version) {\n    case '\"proto2\"':\n      version = 2\n      break\n\n    case '\"proto3\"':\n      version = 3\n      break\n\n    default:\n      throw new Error('Expected protobuf syntax version but found ' + version)\n  }\n\n  if (tokens[0] !== ';') throw new Error('Expected ; but found ' + tokens[0])\n  tokens.shift()\n\n  return version\n}\n\nvar onenumvalue = function (tokens) {\n  if (tokens.length < 4) throw new Error('Invalid enum value: ' + tokens.slice(0, 3).join(' '))\n  if (tokens[1] !== '=') throw new Error('Expected = but found ' + tokens[1])\n  if (tokens[3] !== ';') throw new Error('Expected ; but found ' + tokens[1])\n\n  var name = tokens.shift()\n  tokens.shift()\n\n  var value = Number(tokens.shift())\n  tokens.shift()\n\n  return {\n    name: name,\n    value: value\n  }\n}\n\nvar onenum = function (tokens) {\n  tokens.shift()\n\n  var e = {\n    name: tokens.shift(),\n    values: {}\n  }\n\n  if (tokens[0] !== '{') throw new Error('Expected { but found ' + tokens[0])\n  tokens.shift()\n\n  while (tokens.length) {\n    if (tokens[0] === '}') {\n      tokens.shift()\n      // there goes optional semicolon after the enclosing \"}\"\n      if (tokens[0] === ';') tokens.shift()\n      return e\n    }\n    if (tokens[0] === 'option') {\n      // just skip \"option allow_alias = true;\"\n      while (tokens.shift() !== ';') {\n        // do nothing\n      }\n    }\n    var val = onenumvalue(tokens)\n    e.values[val.name] = val.value\n  }\n\n  throw new Error('No closing tag for enum')\n}\n\nvar onoption = function (tokens) {\n  var name = null\n  var value = null\n\n  var parse = function (value) {\n    if (value === 'true') return true\n    if (value === 'false') return false\n    return value.replace(/^\"+|\"+$/gm, '')\n  }\n\n  while (tokens.length) {\n    if (tokens[0] === ';') {\n      tokens.shift()\n      return {name: name, value: value}\n    }\n    switch (tokens[0]) {\n      case 'option':\n        tokens.shift()\n\n        var hasBracket = tokens[0] === '('\n        if (hasBracket) tokens.shift()\n\n        name = tokens.shift()\n\n        if (hasBracket) {\n          if (tokens[0] !== ')') throw new Error('Expected ) but found ' + tokens[0])\n          tokens.shift()\n        }\n        break\n\n      case '=':\n        tokens.shift()\n        if (name === null) throw new Error('Expected key for option with value: ' + tokens[0])\n        value = parse(tokens.shift())\n\n        if (name === 'optimize_for' && !/^(SPEED|CODE_SIZE|LITE_RUNTIME)$/.test(value)) {\n          throw new Error('Unexpected value for option optimize_for: ' + value)\n        } else if (value === '{') {\n          // option foo = {bar: baz}\n          value = onoptionMap(tokens)\n        }\n        break\n\n      default:\n        throw new Error('Unexpected token in option: ' + tokens[0])\n    }\n  }\n}\n\nvar onoptionMap = function (tokens) {\n  var parse = function (value) {\n    if (value === 'true') return true\n    if (value === 'false') return false\n    return value.replace(/^\"+|\"+$/gm, '')\n  }\n\n  var map = {}\n\n  while (tokens.length) {\n    if (tokens[0] === '}') {\n      tokens.shift()\n      return map\n    }\n\n    var hasBracket = tokens[0] === '('\n    if (hasBracket) tokens.shift()\n\n    var key = tokens.shift()\n    if (hasBracket) {\n      if (tokens[0] !== ')') throw new Error('Expected ) but found ' + tokens[0])\n      tokens.shift()\n    }\n\n    var value = null\n\n    switch (tokens[0]) {\n      case ':':\n        if (map[key] !== undefined) throw new Error('Duplicate option map key ' + key)\n\n        tokens.shift()\n\n        value = parse(tokens.shift())\n\n        if (value === '{') {\n          // option foo = {bar: baz}\n          value = onoptionMap(tokens)\n        }\n\n        map[key] = value\n        break\n\n      case '{':\n        tokens.shift()\n        value = onoptionMap(tokens)\n\n        if (map[key] === undefined) map[key] = []\n        if (!Array.isArray(map[key])) throw new Error('Duplicate option map key ' + key)\n\n        map[key].push(value)\n        break\n\n      default:\n        throw new Error('Unexpected token in option map: ' + tokens[0])\n    }\n  }\n\n  throw new Error('No closing tag for option map')\n}\n\nvar onimport = function (tokens) {\n  tokens.shift()\n  var file = tokens.shift().replace(/^\"+|\"+$/gm, '')\n\n  if (tokens[0] !== ';') throw new Error('Unexpected token: ' + tokens[0] + '. Expected \";\"')\n\n  tokens.shift()\n  return file\n}\n\nvar onservice = function (tokens) {\n  tokens.shift()\n\n  var service = {\n    name: tokens.shift(),\n    methods: [],\n    options: {}\n  }\n\n  if (tokens[0] !== '{') throw new Error('Expected { but found ' + tokens[0])\n  tokens.shift()\n\n  while (tokens.length) {\n    if (tokens[0] === '}') {\n      tokens.shift()\n      // there goes optional semicolon after the enclosing \"}\"\n      if (tokens[0] === ';') tokens.shift()\n      return service\n    }\n\n    switch (tokens[0]) {\n      case 'option':\n        var opt = onoption(tokens)\n        if (service.options[opt.name] !== undefined) throw new Error('Duplicate option ' + opt.name)\n        service.options[opt.name] = opt.value\n        break\n      case 'rpc':\n        service.methods.push(onrpc(tokens))\n        break\n      default:\n        throw new Error('Unexpected token in service: ' + tokens[0])\n    }\n  }\n\n  throw new Error('No closing tag for service')\n}\n\nvar onrpc = function (tokens) {\n  tokens.shift()\n\n  var rpc = {\n    name: tokens.shift(),\n    input_type: null,\n    output_type: null,\n    client_streaming: false,\n    server_streaming: false,\n    options: {}\n  }\n\n  if (tokens[0] !== '(') throw new Error('Expected ( but found ' + tokens[0])\n  tokens.shift()\n\n  if (tokens[0] === 'stream') {\n    tokens.shift()\n    rpc.client_streaming = true\n  }\n\n  rpc.input_type = tokens.shift()\n\n  if (tokens[0] !== ')') throw new Error('Expected ) but found ' + tokens[0])\n  tokens.shift()\n\n  if (tokens[0] !== 'returns') throw new Error('Expected returns but found ' + tokens[0])\n  tokens.shift()\n\n  if (tokens[0] !== '(') throw new Error('Expected ( but found ' + tokens[0])\n  tokens.shift()\n\n  if (tokens[0] === 'stream') {\n    tokens.shift()\n    rpc.server_streaming = true\n  }\n\n  rpc.output_type = tokens.shift()\n\n  if (tokens[0] !== ')') throw new Error('Expected ) but found ' + tokens[0])\n  tokens.shift()\n\n  if (tokens[0] === ';') {\n    tokens.shift()\n    return rpc\n  }\n\n  if (tokens[0] !== '{') throw new Error('Expected { but found ' + tokens[0])\n  tokens.shift()\n\n  while (tokens.length) {\n    if (tokens[0] === '}') {\n      tokens.shift()\n      // there goes optional semicolon after the enclosing \"}\"\n      if (tokens[0] === ';') tokens.shift()\n      return rpc\n    }\n\n    if (tokens[0] === 'option') {\n      var opt = onoption(tokens)\n      if (rpc.options[opt.name] !== undefined) throw new Error('Duplicate option ' + opt.name)\n      rpc.options[opt.name] = opt.value\n    } else {\n      throw new Error('Unexpected token in rpc options: ' + tokens[0])\n    }\n  }\n\n  throw new Error('No closing tag for rpc')\n}\n\nvar parse = function (buf) {\n  var tokens = tokenize(buf.toString())\n  // check for isolated strings in tokens by looking for opening quote\n  for (var i = 0; i < tokens.length; i++) {\n    if (/^(\\\"|\\')([^\\'\\\"]*)$/.test(tokens[i])) {\n      var j\n      if (tokens[i].length === 1) {\n        j = i + 1\n      } else {\n        j = i\n      }\n      // look ahead for the closing quote and collapse all\n      // in-between tokens into a single token\n      for (j; j < tokens.length; j++) {\n        if (/^([^\\'\\\"]*)(\\\"|\\')$/.test(tokens[j])) {\n          tokens = tokens.slice(0, i).concat(tokens.slice(i, j + 1).join('')).concat(tokens.slice(j + 1))\n          break\n        }\n      }\n    }\n  }\n  var schema = {\n    syntax: 3,\n    package: null,\n    imports: [],\n    enums: [],\n    messages: [],\n    options: {},\n    extends: []\n  }\n\n  var firstline = true\n\n  while (tokens.length) {\n    switch (tokens[0]) {\n      case 'package':\n        schema.package = onpackagename(tokens)\n        break\n\n      case 'syntax':\n        if (!firstline) throw new Error('Protobuf syntax version should be first thing in file')\n        schema.syntax = onsyntaxversion(tokens)\n        break\n\n      case 'message':\n        schema.messages.push(onmessage(tokens))\n        break\n\n      case 'enum':\n        schema.enums.push(onenum(tokens))\n        break\n\n      case 'option':\n        var opt = onoption(tokens)\n        if (schema.options[opt.name]) throw new Error('Duplicate option ' + opt.name)\n        schema.options[opt.name] = opt.value\n        break\n\n      case 'import':\n        schema.imports.push(onimport(tokens))\n        break\n\n      case 'extend':\n        schema.extends.push(onextend(tokens))\n        break\n\n      case 'service':\n        if (!schema.services) schema.services = []\n        schema.services.push(onservice(tokens))\n        break\n\n      default:\n        throw new Error('Unexpected token: ' + tokens[0])\n    }\n    firstline = false\n  }\n\n  // now iterate over messages and propagate extends\n  schema.extends.forEach(function (ext) {\n    schema.messages.forEach(function (msg) {\n      if (msg.name === ext.name) {\n        ext.message.fields.forEach(function (field) {\n          if (!msg.extensions || field.tag < msg.extensions.from || field.tag > msg.extensions.to) {\n            throw new Error(msg.name + ' does not declare ' + field.tag + ' as an extension number')\n          }\n          msg.fields.push(field)\n        })\n      }\n    })\n  })\n\n  return schema\n}\n\nmodule.exports = parse\n\n\n/***/ }),\n\n/***/ \"lelp\":\n/***/ (function(module, exports) {\n\nmodule.exports = function (sch) {\n  var noComments = function (line) {\n    var i = line.indexOf('//')\n    return i > -1 ? line.slice(0, i) : line\n  }\n\n  var noMultilineComments = function () {\n    var inside = false\n    return function (token) {\n      if (token === '/*') {\n        inside = true\n        return false\n      }\n      if (token === '*/') {\n        inside = false\n        return false\n      }\n      return !inside\n    }\n  }\n\n  var trim = function (line) {\n    return line.trim()\n  }\n\n  return sch\n    .replace(/([;,{}\\(\\)=\\:\\[\\]<>]|\\/\\*|\\*\\/)/g, ' $1 ')\n    .split(/\\n/)\n    .map(trim)\n    .filter(Boolean)\n    .map(noComments)\n    .map(trim)\n    .filter(Boolean)\n    .join('\\n')\n    .split(/\\s+|\\n+/gm)\n    .filter(noMultilineComments())\n}\n\n\n/***/ }),\n\n/***/ \"pIeg\":\n/***/ (function(module, exports, __webpack_require__) {\n\nvar protobuf = __webpack_require__(\"CN9R\")\nvar mappings = {\n  'array': 'repeated',\n  'object': 'message',\n  'integer': 'int32',\n  'number': 'int32',\n  'string': 'string',\n  'boolean': 'bool'\n}\n\nmodule.exports = function (schema) {\n  if (typeof schema === 'string') schema = JSON.parse(schema)\n  var result = {\n    syntax: 2,\n    package: null,\n    enums: [],\n    messages: []\n  }\n\n  if (schema.type === 'object') {\n    result.messages.push(Message(schema))\n  }\n  return protobuf.stringify(result)\n}\n\nfunction Message (schema) {\n  var message = {\n    name: schema.name,\n    enums: [],\n    messages: [],\n    fields: []\n  }\n\n  var tag = 1\n  for (var key in schema.properties) {\n    var field = schema.properties[key]\n    if (field.type === 'object') {\n      field.name = key\n      message.messages.push(Message(field))\n    } else {\n      field.name = key\n      message.fields.push(Field(field, tag))\n      tag += 1\n    }\n  }\n\n  for (var i in schema.required) {\n    var required = schema.required[i]\n    for (var i in message.fields) {\n      var field = message.fields[i]\n      if (required === field.name) field.required = true\n    }\n  }\n\n  return message\n}\n\nfunction Field (field, tag) {\n  var type = mappings[field.type] || field.type\n  var repeated = false\n\n  if (field.type === 'array') {\n    repeated = true\n    type = field.items.type\n  }\n\n  return {\n    name: field.name,\n    type: type,\n    tag: tag,\n    repeated: repeated\n  }\n}\n\n\n/***/ }),\n\n/***/ \"pof7\":\n/***/ (function(module, exports, __webpack_require__) {\n\n\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/json-schema-to-protobuf\",\n      function () {\n        return __webpack_require__(\"apke\");\n      }\n    ]);\n  \n\n/***/ })\n\n},[[\"pof7\",1,2,0,3]]]);","inputSourceMap":{"version":3,"sources":["/Users/songxu/Develop/test/transform/node_modules/protocol-buffers-schema/index.js","/Users/songxu/Develop/test/transform/node_modules/protocol-buffers-schema/stringify.js","/Users/songxu/Develop/test/transform/node_modules/next/dist/build/webpack/loaders/next-babel-loader.js??ref--5!/Users/songxu/Develop/test/transform/pages/json-schema-to-protobuf.tsx","/Users/songxu/Develop/test/transform/node_modules/protocol-buffers-schema/parse.js","/Users/songxu/Develop/test/transform/node_modules/protocol-buffers-schema/tokenize.js","/Users/songxu/Develop/test/transform/node_modules/jsonschema-protobuf/index.js","/Users/songxu/Develop/test/transform/node_modules/next/dist/build/webpack/loaders/next-client-pages-loader.js?page=%2Fjson-schema-to-protobuf&absolutePagePath=private-next-pages%2Fjson-schema-to-protobuf.tsx!"],"names":[],"mappings":";;;;;;AAAA,YAAY,mBAAO,CAAC,MAAS;AAC7B,gBAAgB,mBAAO,CAAC,MAAa;;AAErC;AACA;AACA;;;;;;;;ACLA;AACA;AACA;AACA;;AAEA,wCAAwC;AACxC;AACA,GAAG;;AAEH;;AAEA,uHAAuH;AACvH;AACA;;AAEA;AACA,uCAAuC;;AAEvC;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,GAAG;;AAEH;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;;AAEH;AACA,wCAAwC;AACxC,qBAAqB;AACrB;AACA,GAAG;;AAEH,gBAAgB;AAChB;AACA;;AAEA;AACA,oCAAoC;;AAEpC;AACA,2CAA2C;AAC3C,GAAG;;AAEH;AACA,gBAAgB;AAChB;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA,0DAA0D,SAAS;AACnE,KAAK;AACL;AACA,qDAAqD;AACrD;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,2CAA2C,QAAQ;AACnD,SAAS;AACT,OAAO;AACP;AACA,yCAAyC,QAAQ;AACjD;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA,uCAAuC;;AAEvC;;AAEA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH,gBAAgB;AAChB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,yBAAyB,2BAA2B;AACpD,GAAG;AACH,wBAAwB;AACxB;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,qDAAqD;;AAErD,kEAAkE;;AAElE;;AAEA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;;;;;;;;;ACtLA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAgD;AACiF;AACe;AACtF;AAC3B;AACK;AACM;AAC3B;AACf,oBAAoB,yDAAW;AAC/B,gBAAgB,sKAAiB,eAAe,oIAAmB;AACnE;AACA,aAAa,oIAAmB;AAChC;AACA;AACA;AACA;AACA,+CAA+C,0DAAO;;AAEtD;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;;AAEL;AACA;AACA;AACA,GAAG;AACH,sBAAsB,6DAAI,CAAC,2EAAe;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,C;;;;;;;ACtCA,eAAe,mBAAO,CAAC,MAAY;AACnC;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,aAAa;AACb;AACA;;AAEA;AACA;AACA;AACA;;AAEA,uBAAuB;AACvB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA,+BAA+B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,aAAa;AACb;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,6BAA6B;AACxD,UAAU;AACV;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,sBAAsB,8BAA8B;AACpD;;AAEA;AACA,wBAAwB;AACxB,6BAA6B;;AAE7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,sBAAsB,8BAA8B;AACpD;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,sBAAsB,8BAA8B;AACpD;;AAEA;AACA;;AAEA;AACA;AACA;AACA,sBAAsB,8BAA8B;;AAEpD;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,sBAAsB,8BAA8B;AACpD;;AAEA;AACA,wBAAwB;AACxB;AACA,6DAA6D;AAC7D,0BAA0B;AAC1B;AACA;AACA;AACA,8CAA8C;AAC9C,kCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,wBAAwB;AACxB;AACA,cAAc;AACd;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,SAAS,sBAAsB;AAC/B,2BAA2B;AAC3B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,wBAAwB;AACxB;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA,wBAAwB;AACxB,2BAA2B;AAC3B;AACA;;AAEA;AACA;;AAEA,aAAa;AACb;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,sBAAsB,oEAAoE;;AAE1F;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,sBAAsB,8BAA8B;AACpD;;AAEA;AACA,wBAAwB;AACxB;AACA,6DAA6D;AAC7D,0BAA0B;AAC1B;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA,sBAAsB;AACtB;AACA;AACA;;AAEA,sBAAsB,8BAA8B;AACpD;;AAEA;AACA,wBAAwB;AACxB;AACA,6DAA6D;AAC7D,0BAA0B;AAC1B;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB,mBAAmB;AACpC;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,aAAa,mBAAmB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL,GAAG;;AAEH;AACA;;AAEA;;;;;;;;AChmBA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,iBAAiB,GAAG;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACpCA,eAAe,mBAAO,CAAC,MAAyB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;ACvEA;AACA;AACA;AACA,eAAe,mBAAO,CAAC,MAAgD;AACvE;AACA","file":"x","sourcesContent":["var parse = require('./parse')\nvar stringify = require('./stringify')\n\nmodule.exports = parse\nmodule.exports.parse = parse\nmodule.exports.stringify = stringify\n","var onfield = function (f, result) {\n  var prefix = f.repeated ? 'repeated' : f.required ? 'required' : 'optional'\n  if (f.type === 'map') prefix = 'map<' + f.map.from + ',' + f.map.to + '>'\n  if (f.oneof) prefix = ''\n\n  var opts = Object.keys(f.options || {}).map(function (key) {\n    return key + ' = ' + f.options[key]\n  }).join(',')\n\n  if (opts) opts = ' [' + opts + ']'\n\n  result.push((prefix ? prefix + ' ' : '') + (f.map === 'map' ? '' : f.type + ' ') + f.name + ' = ' + f.tag + opts + ';')\n  return result\n}\n\nvar onmessage = function (m, result) {\n  result.push('message ' + m.name + ' {')\n\n  if (!m.enums) m.enums = []\n  m.enums.forEach(function (e) {\n    result.push(onenum(e, []))\n  })\n\n  if (!m.messages) m.messages = []\n  m.messages.forEach(function (m) {\n    result.push(onmessage(m, []))\n  })\n\n  var oneofs = {}\n\n  if (!m.fields) m.fields = []\n  m.fields.forEach(function (f) {\n    if (f.oneof) {\n      if (!oneofs[f.oneof]) oneofs[f.oneof] = []\n      oneofs[f.oneof].push(onfield(f, []))\n    } else {\n      result.push(onfield(f, []))\n    }\n  })\n\n  Object.keys(oneofs).forEach(function (n) {\n    oneofs[n].unshift('oneof ' + n + ' {')\n    oneofs[n].push('}')\n    result.push(oneofs[n])\n  })\n\n  result.push('}', '')\n  return result\n}\n\nvar onenum = function (e, result) {\n  result.push('enum ' + e.name + ' {')\n\n  var vals = Object.keys(e.values).map(function (key) {\n    return key + ' = ' + e.values[key] + ';'\n  })\n\n  result.push(vals)\n  result.push('}', '')\n  return result\n}\n\nvar onoption = function (o, result) {\n  var keys = Object.keys(o)\n  keys.forEach(function (option) {\n    var v = o[option]\n\n    if (~option.indexOf('.')) option = '(' + option + ')'\n\n    var type = typeof v\n\n    if (type === 'object') {\n      v = onoptionMap(v, [])\n      if (v.length) result.push('option ' + option + ' = {', v, '};')\n    } else {\n      if (type === 'string' && option !== 'optimize_for') v = '\"' + v + '\"'\n      result.push('option ' + option + ' = ' + v + ';')\n    }\n  })\n  if (keys.length > 0) {\n    result.push('')\n  }\n\n  return result\n}\n\nvar onoptionMap = function (o, result) {\n  var keys = Object.keys(o)\n  keys.forEach(function (k) {\n    var v = o[k]\n\n    var type = typeof v\n\n    if (type === 'object') {\n      if (Array.isArray(v)) {\n        v.forEach(function (v) {\n          v = onoptionMap(v, [])\n          if (v.length) result.push(k + ' {', v, '}')\n        })\n      } else {\n        v = onoptionMap(v, [])\n        if (v.length) result.push(k + ' {', v, '}')\n      }\n    } else {\n      if (type === 'string') v = '\"' + v + '\"'\n      result.push(k + ': ' + v)\n    }\n  })\n\n  return result\n}\n\nvar onservices = function (s, result) {\n  result.push('service ' + s.name + ' {')\n\n  if (!s.options) s.options = {}\n\n  onoption(s.options, result)\n\n  if (!s.methods) s.methods = []\n  s.methods.forEach(function (m) {\n    result.push(onrpc(m, []))\n  })\n\n  result.push('}', '')\n  return result\n}\n\nvar onrpc = function (rpc, result) {\n  var def = 'rpc ' + rpc.name + '('\n  if (rpc.client_streaming) def += 'stream '\n  def += rpc.input_type + ') returns ('\n  if (rpc.server_streaming) def += 'stream '\n  def += rpc.output_type + ')'\n\n  if (!rpc.options) rpc.options = {}\n\n  var options = onoption(rpc.options, [])\n  if (options.length > 1) {\n    result.push(def + ' {', options.slice(0, -1), '}')\n  } else {\n    result.push(def + ';')\n  }\n\n  return result\n}\n\nvar indent = function (lvl) {\n  return function (line) {\n    if (Array.isArray(line)) return line.map(indent(lvl + '  ')).join('\\n')\n    return lvl + line\n  }\n}\n\nmodule.exports = function (schema) {\n  var result = []\n\n  result.push('syntax = \"proto' + schema.syntax + '\";', '')\n\n  if (schema.package) result.push('package ' + schema.package + ';', '')\n\n  if (!schema.options) schema.options = {}\n\n  onoption(schema.options, result)\n\n  if (!schema.enums) schema.enums = []\n  schema.enums.forEach(function (e) {\n    onenum(e, result)\n  })\n\n  if (!schema.messages) schema.messages = []\n  schema.messages.forEach(function (m) {\n    onmessage(m, result)\n  })\n\n  if (schema.services) {\n    schema.services.forEach(function (s) {\n      onservices(s, result)\n    })\n  }\n\n  return result.map(indent('')).join('\\n')\n}\n","import { jsx as _jsx } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"/Users/songxu/Develop/test/transform/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/songxu/Develop/test/transform/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport ConversionPanel from \"@components/ConversionPanel\";\nimport * as React from \"react\";\nimport { useCallback } from \"react\";\nimport convert from \"jsonschema-protobuf\";\nexport default function JsonSchemaToProtobuf() {\n  var transformer = useCallback( /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref) {\n      var value;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              value = _ref.value;\n              return _context.abrupt(\"return\", convert(value));\n\n            case 2:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function (_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }(), []);\n  return /*#__PURE__*/_jsx(ConversionPanel, {\n    transformer: transformer,\n    editorTitle: \"JSON Schema\",\n    editorLanguage: \"json\",\n    editorDefaultValue: \"jsonSchema\",\n    resultTitle: \"Protobuf\",\n    resultLanguage: \"text\"\n  });\n}","var tokenize = require('./tokenize')\nvar MAX_RANGE = 0x1FFFFFFF\n\nvar onfieldoptions = function (tokens) {\n  var opts = {}\n\n  while (tokens.length) {\n    switch (tokens[0]) {\n      case '[':\n      case ',':\n        tokens.shift()\n        var name = tokens.shift()\n        if (name === '(') {       // handling [(A) = B]\n          name = tokens.shift()\n          tokens.shift()          // remove the end of bracket\n        }\n        if (tokens[0] !== '=') throw new Error('Unexpected token in field options: ' + tokens[0])\n        tokens.shift()\n        if (tokens[0] === ']') throw new Error('Unexpected ] in field option')\n        opts[name] = tokens.shift()\n        break\n      case ']':\n        tokens.shift()\n        return opts\n\n      default:\n        throw new Error('Unexpected token in field options: ' + tokens[0])\n    }\n  }\n\n  throw new Error('No closing tag for field options')\n}\n\nvar onfield = function (tokens) {\n  var field = {\n    name: null,\n    type: null,\n    tag: 0,\n    map: null,\n    oneof: null,\n    required: false,\n    repeated: false,\n    options: {}\n  }\n\n  while (tokens.length) {\n    switch (tokens[0]) {\n      case '=':\n        tokens.shift()\n        field.tag = Number(tokens.shift())\n        break\n\n      case 'map':\n        field.type = 'map'\n        field.map = {from: null, to: null}\n        tokens.shift()\n        if (tokens[0] !== '<') throw new Error('Unexpected token in map type: ' + tokens[0])\n        tokens.shift()\n        field.map.from = tokens.shift()\n        if (tokens[0] !== ',') throw new Error('Unexpected token in map type: ' + tokens[0])\n        tokens.shift()\n        field.map.to = tokens.shift()\n        if (tokens[0] !== '>') throw new Error('Unexpected token in map type: ' + tokens[0])\n        tokens.shift()\n        field.name = tokens.shift()\n        break\n\n      case 'repeated':\n      case 'required':\n      case 'optional':\n        var t = tokens.shift()\n        field.required = t === 'required'\n        field.repeated = t === 'repeated'\n        field.type = tokens.shift()\n        field.name = tokens.shift()\n        break\n\n      case '[':\n        field.options = onfieldoptions(tokens)\n        break\n\n      case ';':\n        tokens.shift()\n        return field\n\n      default:\n        throw new Error('Unexpected token in message field: ' + tokens[0])\n    }\n  }\n\n  throw new Error('No ; found for message field')\n}\n\nvar onmessagebody = function (tokens) {\n  var body = {\n    enums: [],\n    messages: [],\n    fields: [],\n    extensions: null\n  }\n\n  while (tokens.length) {\n    switch (tokens[0]) {\n      case 'map':\n      case 'repeated':\n      case 'optional':\n      case 'required':\n        body.fields.push(onfield(tokens))\n        break\n\n      case 'enum':\n        body.enums.push(onenum(tokens))\n        break\n\n      case 'message':\n        body.messages.push(onmessage(tokens))\n        break\n\n      case 'extensions':\n        body.extensions = onextensions(tokens)\n        break\n\n      case 'oneof':\n        tokens.shift()\n        var name = tokens.shift()\n        if (tokens[0] !== '{') throw new Error('Unexpected token in oneof: ' + tokens[0])\n        tokens.shift()\n        while (tokens[0] !== '}') {\n          tokens.unshift('optional')\n          var field = onfield(tokens)\n          field.oneof = name\n          body.fields.push(field)\n        }\n        tokens.shift()\n        break\n\n      case ';':\n        tokens.shift()\n        break\n\n      default:\n        // proto3 does not require the use of optional/required, assumed as optional\n        // \"singular: a well-formed message can have zero or one of this field (but not more than one).\"\n        // https://developers.google.com/protocol-buffers/docs/proto3#specifying-field-rules\n        tokens.unshift('optional')\n        body.fields.push(onfield(tokens))\n    }\n  }\n\n  return body\n}\n\nvar onextend = function (tokens) {\n  var out = {\n    name: tokens[1],\n    message: onmessage(tokens)\n  }\n  return out\n}\n\nvar onextensions = function (tokens) {\n  tokens.shift()\n  var from = Number(tokens.shift())\n  if (isNaN(from)) throw new Error('Invalid from in extensions definition')\n  if (tokens.shift() !== 'to') throw new Error(\"Expected keyword 'to' in extensions definition\")\n  var to = tokens.shift()\n  if (to === 'max') to = MAX_RANGE\n  to = Number(to)\n  if (isNaN(to)) throw new Error('Invalid to in extensions definition')\n  if (tokens.shift() !== ';') throw new Error('Missing ; in extensions definition')\n  return {from: from, to: to}\n}\nvar onmessage = function (tokens) {\n  tokens.shift()\n\n  var lvl = 1\n  var body = []\n  var msg = {\n    name: tokens.shift(),\n    enums: [],\n    messages: [],\n    fields: []\n  }\n\n  if (tokens[0] !== '{') throw new Error('Expected { but found ' + tokens[0])\n  tokens.shift()\n\n  while (tokens.length) {\n    if (tokens[0] === '{') lvl++\n    else if (tokens[0] === '}') lvl--\n\n    if (!lvl) {\n      tokens.shift()\n      body = onmessagebody(body)\n      msg.enums = body.enums\n      msg.messages = body.messages\n      msg.fields = body.fields\n      msg.extensions = body.extensions\n      return msg\n    }\n\n    body.push(tokens.shift())\n  }\n\n  if (lvl) throw new Error('No closing tag for message')\n}\n\nvar onpackagename = function (tokens) {\n  tokens.shift()\n  var name = tokens.shift()\n  if (tokens[0] !== ';') throw new Error('Expected ; but found ' + tokens[0])\n  tokens.shift()\n  return name\n}\n\nvar onsyntaxversion = function (tokens) {\n  tokens.shift()\n\n  if (tokens[0] !== '=') throw new Error('Expected = but found ' + tokens[0])\n  tokens.shift()\n\n  var version = tokens.shift()\n  switch (version) {\n    case '\"proto2\"':\n      version = 2\n      break\n\n    case '\"proto3\"':\n      version = 3\n      break\n\n    default:\n      throw new Error('Expected protobuf syntax version but found ' + version)\n  }\n\n  if (tokens[0] !== ';') throw new Error('Expected ; but found ' + tokens[0])\n  tokens.shift()\n\n  return version\n}\n\nvar onenumvalue = function (tokens) {\n  if (tokens.length < 4) throw new Error('Invalid enum value: ' + tokens.slice(0, 3).join(' '))\n  if (tokens[1] !== '=') throw new Error('Expected = but found ' + tokens[1])\n  if (tokens[3] !== ';') throw new Error('Expected ; but found ' + tokens[1])\n\n  var name = tokens.shift()\n  tokens.shift()\n\n  var value = Number(tokens.shift())\n  tokens.shift()\n\n  return {\n    name: name,\n    value: value\n  }\n}\n\nvar onenum = function (tokens) {\n  tokens.shift()\n\n  var e = {\n    name: tokens.shift(),\n    values: {}\n  }\n\n  if (tokens[0] !== '{') throw new Error('Expected { but found ' + tokens[0])\n  tokens.shift()\n\n  while (tokens.length) {\n    if (tokens[0] === '}') {\n      tokens.shift()\n      // there goes optional semicolon after the enclosing \"}\"\n      if (tokens[0] === ';') tokens.shift()\n      return e\n    }\n    if (tokens[0] === 'option') {\n      // just skip \"option allow_alias = true;\"\n      while (tokens.shift() !== ';') {\n        // do nothing\n      }\n    }\n    var val = onenumvalue(tokens)\n    e.values[val.name] = val.value\n  }\n\n  throw new Error('No closing tag for enum')\n}\n\nvar onoption = function (tokens) {\n  var name = null\n  var value = null\n\n  var parse = function (value) {\n    if (value === 'true') return true\n    if (value === 'false') return false\n    return value.replace(/^\"+|\"+$/gm, '')\n  }\n\n  while (tokens.length) {\n    if (tokens[0] === ';') {\n      tokens.shift()\n      return {name: name, value: value}\n    }\n    switch (tokens[0]) {\n      case 'option':\n        tokens.shift()\n\n        var hasBracket = tokens[0] === '('\n        if (hasBracket) tokens.shift()\n\n        name = tokens.shift()\n\n        if (hasBracket) {\n          if (tokens[0] !== ')') throw new Error('Expected ) but found ' + tokens[0])\n          tokens.shift()\n        }\n        break\n\n      case '=':\n        tokens.shift()\n        if (name === null) throw new Error('Expected key for option with value: ' + tokens[0])\n        value = parse(tokens.shift())\n\n        if (name === 'optimize_for' && !/^(SPEED|CODE_SIZE|LITE_RUNTIME)$/.test(value)) {\n          throw new Error('Unexpected value for option optimize_for: ' + value)\n        } else if (value === '{') {\n          // option foo = {bar: baz}\n          value = onoptionMap(tokens)\n        }\n        break\n\n      default:\n        throw new Error('Unexpected token in option: ' + tokens[0])\n    }\n  }\n}\n\nvar onoptionMap = function (tokens) {\n  var parse = function (value) {\n    if (value === 'true') return true\n    if (value === 'false') return false\n    return value.replace(/^\"+|\"+$/gm, '')\n  }\n\n  var map = {}\n\n  while (tokens.length) {\n    if (tokens[0] === '}') {\n      tokens.shift()\n      return map\n    }\n\n    var hasBracket = tokens[0] === '('\n    if (hasBracket) tokens.shift()\n\n    var key = tokens.shift()\n    if (hasBracket) {\n      if (tokens[0] !== ')') throw new Error('Expected ) but found ' + tokens[0])\n      tokens.shift()\n    }\n\n    var value = null\n\n    switch (tokens[0]) {\n      case ':':\n        if (map[key] !== undefined) throw new Error('Duplicate option map key ' + key)\n\n        tokens.shift()\n\n        value = parse(tokens.shift())\n\n        if (value === '{') {\n          // option foo = {bar: baz}\n          value = onoptionMap(tokens)\n        }\n\n        map[key] = value\n        break\n\n      case '{':\n        tokens.shift()\n        value = onoptionMap(tokens)\n\n        if (map[key] === undefined) map[key] = []\n        if (!Array.isArray(map[key])) throw new Error('Duplicate option map key ' + key)\n\n        map[key].push(value)\n        break\n\n      default:\n        throw new Error('Unexpected token in option map: ' + tokens[0])\n    }\n  }\n\n  throw new Error('No closing tag for option map')\n}\n\nvar onimport = function (tokens) {\n  tokens.shift()\n  var file = tokens.shift().replace(/^\"+|\"+$/gm, '')\n\n  if (tokens[0] !== ';') throw new Error('Unexpected token: ' + tokens[0] + '. Expected \";\"')\n\n  tokens.shift()\n  return file\n}\n\nvar onservice = function (tokens) {\n  tokens.shift()\n\n  var service = {\n    name: tokens.shift(),\n    methods: [],\n    options: {}\n  }\n\n  if (tokens[0] !== '{') throw new Error('Expected { but found ' + tokens[0])\n  tokens.shift()\n\n  while (tokens.length) {\n    if (tokens[0] === '}') {\n      tokens.shift()\n      // there goes optional semicolon after the enclosing \"}\"\n      if (tokens[0] === ';') tokens.shift()\n      return service\n    }\n\n    switch (tokens[0]) {\n      case 'option':\n        var opt = onoption(tokens)\n        if (service.options[opt.name] !== undefined) throw new Error('Duplicate option ' + opt.name)\n        service.options[opt.name] = opt.value\n        break\n      case 'rpc':\n        service.methods.push(onrpc(tokens))\n        break\n      default:\n        throw new Error('Unexpected token in service: ' + tokens[0])\n    }\n  }\n\n  throw new Error('No closing tag for service')\n}\n\nvar onrpc = function (tokens) {\n  tokens.shift()\n\n  var rpc = {\n    name: tokens.shift(),\n    input_type: null,\n    output_type: null,\n    client_streaming: false,\n    server_streaming: false,\n    options: {}\n  }\n\n  if (tokens[0] !== '(') throw new Error('Expected ( but found ' + tokens[0])\n  tokens.shift()\n\n  if (tokens[0] === 'stream') {\n    tokens.shift()\n    rpc.client_streaming = true\n  }\n\n  rpc.input_type = tokens.shift()\n\n  if (tokens[0] !== ')') throw new Error('Expected ) but found ' + tokens[0])\n  tokens.shift()\n\n  if (tokens[0] !== 'returns') throw new Error('Expected returns but found ' + tokens[0])\n  tokens.shift()\n\n  if (tokens[0] !== '(') throw new Error('Expected ( but found ' + tokens[0])\n  tokens.shift()\n\n  if (tokens[0] === 'stream') {\n    tokens.shift()\n    rpc.server_streaming = true\n  }\n\n  rpc.output_type = tokens.shift()\n\n  if (tokens[0] !== ')') throw new Error('Expected ) but found ' + tokens[0])\n  tokens.shift()\n\n  if (tokens[0] === ';') {\n    tokens.shift()\n    return rpc\n  }\n\n  if (tokens[0] !== '{') throw new Error('Expected { but found ' + tokens[0])\n  tokens.shift()\n\n  while (tokens.length) {\n    if (tokens[0] === '}') {\n      tokens.shift()\n      // there goes optional semicolon after the enclosing \"}\"\n      if (tokens[0] === ';') tokens.shift()\n      return rpc\n    }\n\n    if (tokens[0] === 'option') {\n      var opt = onoption(tokens)\n      if (rpc.options[opt.name] !== undefined) throw new Error('Duplicate option ' + opt.name)\n      rpc.options[opt.name] = opt.value\n    } else {\n      throw new Error('Unexpected token in rpc options: ' + tokens[0])\n    }\n  }\n\n  throw new Error('No closing tag for rpc')\n}\n\nvar parse = function (buf) {\n  var tokens = tokenize(buf.toString())\n  // check for isolated strings in tokens by looking for opening quote\n  for (var i = 0; i < tokens.length; i++) {\n    if (/^(\\\"|\\')([^\\'\\\"]*)$/.test(tokens[i])) {\n      var j\n      if (tokens[i].length === 1) {\n        j = i + 1\n      } else {\n        j = i\n      }\n      // look ahead for the closing quote and collapse all\n      // in-between tokens into a single token\n      for (j; j < tokens.length; j++) {\n        if (/^([^\\'\\\"]*)(\\\"|\\')$/.test(tokens[j])) {\n          tokens = tokens.slice(0, i).concat(tokens.slice(i, j + 1).join('')).concat(tokens.slice(j + 1))\n          break\n        }\n      }\n    }\n  }\n  var schema = {\n    syntax: 3,\n    package: null,\n    imports: [],\n    enums: [],\n    messages: [],\n    options: {},\n    extends: []\n  }\n\n  var firstline = true\n\n  while (tokens.length) {\n    switch (tokens[0]) {\n      case 'package':\n        schema.package = onpackagename(tokens)\n        break\n\n      case 'syntax':\n        if (!firstline) throw new Error('Protobuf syntax version should be first thing in file')\n        schema.syntax = onsyntaxversion(tokens)\n        break\n\n      case 'message':\n        schema.messages.push(onmessage(tokens))\n        break\n\n      case 'enum':\n        schema.enums.push(onenum(tokens))\n        break\n\n      case 'option':\n        var opt = onoption(tokens)\n        if (schema.options[opt.name]) throw new Error('Duplicate option ' + opt.name)\n        schema.options[opt.name] = opt.value\n        break\n\n      case 'import':\n        schema.imports.push(onimport(tokens))\n        break\n\n      case 'extend':\n        schema.extends.push(onextend(tokens))\n        break\n\n      case 'service':\n        if (!schema.services) schema.services = []\n        schema.services.push(onservice(tokens))\n        break\n\n      default:\n        throw new Error('Unexpected token: ' + tokens[0])\n    }\n    firstline = false\n  }\n\n  // now iterate over messages and propagate extends\n  schema.extends.forEach(function (ext) {\n    schema.messages.forEach(function (msg) {\n      if (msg.name === ext.name) {\n        ext.message.fields.forEach(function (field) {\n          if (!msg.extensions || field.tag < msg.extensions.from || field.tag > msg.extensions.to) {\n            throw new Error(msg.name + ' does not declare ' + field.tag + ' as an extension number')\n          }\n          msg.fields.push(field)\n        })\n      }\n    })\n  })\n\n  return schema\n}\n\nmodule.exports = parse\n","module.exports = function (sch) {\n  var noComments = function (line) {\n    var i = line.indexOf('//')\n    return i > -1 ? line.slice(0, i) : line\n  }\n\n  var noMultilineComments = function () {\n    var inside = false\n    return function (token) {\n      if (token === '/*') {\n        inside = true\n        return false\n      }\n      if (token === '*/') {\n        inside = false\n        return false\n      }\n      return !inside\n    }\n  }\n\n  var trim = function (line) {\n    return line.trim()\n  }\n\n  return sch\n    .replace(/([;,{}\\(\\)=\\:\\[\\]<>]|\\/\\*|\\*\\/)/g, ' $1 ')\n    .split(/\\n/)\n    .map(trim)\n    .filter(Boolean)\n    .map(noComments)\n    .map(trim)\n    .filter(Boolean)\n    .join('\\n')\n    .split(/\\s+|\\n+/gm)\n    .filter(noMultilineComments())\n}\n","var protobuf = require('protocol-buffers-schema')\nvar mappings = {\n  'array': 'repeated',\n  'object': 'message',\n  'integer': 'int32',\n  'number': 'int32',\n  'string': 'string',\n  'boolean': 'bool'\n}\n\nmodule.exports = function (schema) {\n  if (typeof schema === 'string') schema = JSON.parse(schema)\n  var result = {\n    syntax: 2,\n    package: null,\n    enums: [],\n    messages: []\n  }\n\n  if (schema.type === 'object') {\n    result.messages.push(Message(schema))\n  }\n  return protobuf.stringify(result)\n}\n\nfunction Message (schema) {\n  var message = {\n    name: schema.name,\n    enums: [],\n    messages: [],\n    fields: []\n  }\n\n  var tag = 1\n  for (var key in schema.properties) {\n    var field = schema.properties[key]\n    if (field.type === 'object') {\n      field.name = key\n      message.messages.push(Message(field))\n    } else {\n      field.name = key\n      message.fields.push(Field(field, tag))\n      tag += 1\n    }\n  }\n\n  for (var i in schema.required) {\n    var required = schema.required[i]\n    for (var i in message.fields) {\n      var field = message.fields[i]\n      if (required === field.name) field.required = true\n    }\n  }\n\n  return message\n}\n\nfunction Field (field, tag) {\n  var type = mappings[field.type] || field.type\n  var repeated = false\n\n  if (field.type === 'array') {\n    repeated = true\n    type = field.items.type\n  }\n\n  return {\n    name: field.name,\n    type: type,\n    tag: tag,\n    repeated: repeated\n  }\n}\n","\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/json-schema-to-protobuf\",\n      function () {\n        return require(\"private-next-pages/json-schema-to-protobuf.tsx\");\n      }\n    ]);\n  "]}}